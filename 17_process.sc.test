#!/usr/bin/env bash
#> urls.

#>>IN:
#>> google:
#>>  1   2     3   4  5       6        7   8   9     10      11
#>> uid second sz pz  bt exposureprice ad dom path sestart isview
#>> OR
#>> net:
#>> uid second sid sz pz bt exposureprice secondprice divexpsecond ad network dom path sestart isview


#>> sorted by UID,SECOND:
set -x
lb=${1:?labels!}

fields_numbers=`perl -e'
 @F=split /\s+/, shift; 
 %L = map { $F[$_],$_+1 } (0..$#F); 
 print join ",", @L{qw| uid dom path sestart isview |}' "$lb"
`
cut -d* -f$fields_numbers |
 scasca "$0" -main=Proc17 -desti=./targets/$(basename $0).jar -between="#START_SCALA and #STOP_SCALA" |
 LANG=POSIX sort -T. -S 333M -t\* -k1,1 -k2,2


exit

#START_SCALA
import scala.io
import scala.collection.mutable._

object Proc17 extends App {

 val cd = io.Codec.UTF8.onMalformedInput( java.nio.charset.CodingErrorAction.IGNORE )
 val bs = io.Source.fromInputStream( System.in )( cd )
 
 for ( l<-bs.getLines ){
   println(l)
 }

  
}
#STOP_SCALA


#>>OUT:
#>> dom, ref, sessions_count, sessions_ends
#>>  
#>> | field          | description |
#>> | -------------- | ----------- |
#>> | dom |
#>> | ref |
#>> | sessions_count | количество сессий, где dom+url участвовал |
#>> | sessions_ends  | количество сессий, где он был последним.  |





